library(forecast)

conf <- 0.75
h <- 12

csv <- "2012-02-01,5.08
2012-03-01,4.90
2012-04-01,4.98
2012-05-01,5.07
2012-06-01,6.05
2012-07-01,7.94
2012-08-01,10.94
2012-09-01,11.63
2012-10-01,11.73
2012-11-01,11.49
2012-12-01,13.36
2013-01-01,15.60
2013-02-01,26.04
2013-03-01,57.50
2013-04-01,130.34
2013-05-01,119.97
2013-06-01,107.82
2013-07-01,85.65
2013-08-01,103.63
2013-09-01,123.41
2013-10-01,150.72
2013-11-01,534.79
2013-12-01,806.07
2014-01-01,819.43
2014-02-01,660.55
2014-03-01,592.92
2014-04-01,461.96
2014-05-01,482.89
2014-06-01,617.93
2014-07-01,615.27
2014-08-01,535.70
2014-09-01,443.43
2014-10-01,361.50
2014-11-01,364.37
2014-12-01,341.01
2015-01-01,249.36
2015-02-01,234.80
2015-03-01,269.63
2015-04-01,235.42
2015-05-01,236.86
2015-06-01,237.95
2015-07-01,279.42
2015-08-01,250.27
2015-09-01,234.23
2015-10-01,266.20
2015-11-01,349.93
2015-12-01,424.62
2016-01-01,410.08
2016-02-01,404.20
2016-03-01,415.18
2016-04-01,435.16
2016-05-01,461.66
2016-06-01,644.52
2016-07-01,661.64
2016-08-01,507.88
2016-09-01,608.28
2016-10-01,644.97
2016-11-01,735.81
2016-12-01,825.77
2017-01-01,912.26
2017-02-01,1064.72
2017-03-01,1129.64
2017-04-01,1261.43
2017-05-01,1893.11
2017-06-01,2574.95
2017-07-01,2500.55
2017-08-01,3868.43
2017-09-01,4079.48
2017-10-01,5351.16
2017-11-01,7762.56
2017-12-01,14911.38
2018-01-01,12915.57
2018-02-01,9391.55
2018-03-01,8981.56
2018-04-01,8022.14
2018-05-01,8427.33
2018-06-01,6767.49
2018-07-01,7125.02
2018-08-01,6679.38
2018-09-01,6586.14"

df <- read.csv(text = csv,header=FALSE)
df$V1 <- as.Date(df$V1)
input <- ts(df$V2,freq=12,1:N)

data.frame("date" = df$V1, "history" = df$V2)

N <- nrow(df)

extra_dates <- seq(from = df$V1[N],  length.out = h+1, by = "month")[-1]


conf_str <- paste0(as.character(conf*100),"% ")

arima_model <- auto.arima(input, D=1)
arima_forecast <- forecast(arima_model,h=h,level=conf)

hw_forecast <- hw(input,level=conf,h=h)

arima_str = paste0("ARIMA ", c("Lower ","Upper "), conf_str)
hw_str = paste0("ARIMA ", c("Lower ","Upper "), conf_str)

output <- data.frame("date" = c(df$V1,extra_dates), "value" = c(df$V2,rep(NA,h)), 
                     "ARIMA Upper" = c(rep(NA,N),arima_forecast$upper), "ARIMA Mean Forecast" = c(rep(NA,N),arima_forecast$mean), "ARIMA Lower" = c(rep(NA,N),arima_forecast$lower),
                     "HW Upper" = c(rep(NA,N),hw_forecast$upper), "HW Mean Forecast" = c(rep(NA,N),hw_forecast$mean), "HW Lower" = c(rep(NA,N),hw_forecast$lower)
                     )


